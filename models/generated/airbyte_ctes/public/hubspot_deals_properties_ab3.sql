{{ config(schema="_airbyte_public", tags=["nested-intermediate"]) }}
-- SQL model to build a hash column based on the values of this record
select
    *,
    {{ dbt_utils.surrogate_key([
        '_airbyte_hubspot_deals_hashid',
        'amount',
        'hs_acv',
        'hs_arr',
        'hs_mrr',
        'hs_tcv',
        'dealname',
        'dealtype',
        'pipeline',
        'closedate',
        'dealstage',
        'num_notes',
        'createdate',
        'description',
        'hs_priority',
        'hs_is_closed',
        'hs_next_step',
        'hs_object_id',
        'days_to_close',
        'hs_createdate',
        'hs_all_team_ids',
        'hubspot_team_id',
        'hs_all_owner_ids',
        'hs_closed_amount',
        'hs_is_closed_won',
        'hubspot_owner_id',
        'closed_won_reason',
        'closed_lost_reason',
        'hs_forecast_amount',
        'hs_time_in_9567448',
        'hs_time_in_9567449',
        'notes_last_updated',
        'hs_analytics_source',
        'hs_lastmodifieddate',
        'hs_predicted_amount',
        'hs_projected_amount',
        'num_contacted_notes',
        'hs_merged_object_ids',
        'hs_time_in_closedwon',
        'notes_last_contacted',
        'hs_created_by_user_id',
        'hs_time_in_closedlost',
        'hs_updated_by_user_id',
        'hs_date_exited_9567448',
        'hs_date_exited_9567449',
        'hs_likelihood_to_close',
        'hs_num_target_accounts',
        'hs_unique_creation_key',
        'amount_in_home_currency',
        'hs_date_entered_9567448',
        'hs_date_entered_9567449',
        'hs_forecast_probability',
        'hs_time_in_contractsent',
        'num_associated_contacts',
        'hs_date_exited_closedwon',
        'notes_next_activity_date',
        'hs_date_entered_closedwon',
        'hs_date_exited_closedlost',
        'hs_deal_stage_probability',
        'hs_time_in_qualifiedtobuy',
        'hs_user_ids_of_all_owners',
        'hs_all_accessible_team_ids',
        'hs_analytics_source_data_1',
        'hs_analytics_source_data_2',
        'hs_date_entered_closedlost',
        'hs_latest_meeting_activity',
        'hubspot_owner_assigneddate',
        'hs_date_exited_contractsent',
        'hs_manual_forecast_category',
        'hs_sales_email_last_replied',
        'hs_date_entered_contractsent',
        'hs_date_exited_qualifiedtobuy',
        'hs_date_entered_qualifiedtobuy',
        'engagements_last_meeting_booked',
        'hs_time_in_appointmentscheduled',
        'hs_time_in_customclosedwonstage',
        'hs_deal_stage_probability_shadow',
        'hs_time_in_decisionmakerboughtin',
        'hs_time_in_presentationscheduled',
        'hs_all_assigned_business_unit_ids',
        'hs_closed_amount_in_home_currency',
        'hs_date_exited_appointmentscheduled',
        'hs_date_exited_customclosedwonstage',
        'hs_date_entered_appointmentscheduled',
        'hs_date_entered_customclosedwonstage',
        'hs_date_exited_decisionmakerboughtin',
        'hs_date_exited_presentationscheduled',
        'hs_predicted_amount_in_home_currency',
        'hs_projected_amount_in_home_currency',
        'hs_date_entered_decisionmakerboughtin',
        'hs_date_entered_presentationscheduled',
        'hs_deal_amount_calculation_preference',
        'engagements_last_meeting_booked_medium',
        'engagements_last_meeting_booked_source',
        'engagements_last_meeting_booked_campaign',
        'hs_user_ids_of_all_notification_followers',
        'hs_user_ids_of_all_notification_unfollowers',
        'hs_line_item_global___s_discount_percentage',
        'hs_line_item_global___rringbillingfrequency',
        'hs_line_item_global___urring_billing_period',
        'hs_line_item_global___nt_percentage_enabled',
        'hs_line_item_global___ng_billing_start_date',
        'hs_line_item_global___lingfrequency_enabled',
        'hs_line_item_global___illing_period_enabled',
        'hs_line_item_global___ng_start_date_enabled',
    ]) }} as _airbyte_properties_hashid
from {{ ref('hubspot_deals_properties_ab2') }}
-- properties at hubspot_deals/properties

