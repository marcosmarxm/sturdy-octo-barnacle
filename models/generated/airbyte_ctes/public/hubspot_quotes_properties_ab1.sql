{{ config(schema="_airbyte_public", tags=["nested-intermediate"]) }}
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
select
    _airbyte_hubspot_quotes_hashid,
    {{ json_extract_scalar('properties', ['hs_terms']) }} as hs_terms,
    {{ json_extract_scalar('properties', ['hs_title']) }} as hs_title,
    {{ json_extract_scalar('properties', ['hs_locale']) }} as hs_locale,
    {{ json_extract('properties', ['hs_locked']) }} as hs_locked,
    {{ json_extract_scalar('properties', ['hs_status']) }} as hs_status,
    {{ json_extract_scalar('properties', ['num_notes']) }} as num_notes,
    {{ json_extract_scalar('properties', ['hs_comments']) }} as hs_comments,
    {{ json_extract_scalar('properties', ['hs_currency']) }} as hs_currency,
    {{ json_extract_scalar('properties', ['hs_feedback']) }} as hs_feedback,
    {{ json_extract_scalar('properties', ['hs_language']) }} as hs_language,
    {{ json_extract_scalar('properties', ['hs_logo_url']) }} as hs_logo_url,
    {{ json_extract_scalar('properties', ['hs_template']) }} as hs_template,
    {{ json_extract_scalar('properties', ['hs_timezone']) }} as hs_timezone,
    {{ json_extract_scalar('properties', ['hs_object_id']) }} as hs_object_id,
    {{ json_extract('properties', ['hs_createdate']) }} as hs_createdate,
    {{ json_extract('properties', ['hs_esign_date']) }} as hs_esign_date,
    {{ json_extract_scalar('properties', ['hs_approver_id']) }} as hs_approver_id,
    {{ json_extract_scalar('properties', ['hs_all_team_ids']) }} as hs_all_team_ids,
    {{ json_extract('properties', ['hs_payment_date']) }} as hs_payment_date,
    {{ json_extract_scalar('properties', ['hs_quote_amount']) }} as hs_quote_amount,
    {{ json_extract_scalar('properties', ['hs_quote_number']) }} as hs_quote_number,
    {{ json_extract_scalar('properties', ['hs_sender_email']) }} as hs_sender_email,
    {{ json_extract_scalar('properties', ['hs_sender_phone']) }} as hs_sender_phone,
    {{ json_extract_scalar('properties', ['hubspot_team_id']) }} as hubspot_team_id,
    {{ json_extract_scalar('properties', ['hs_all_owner_ids']) }} as hs_all_owner_ids,
    {{ json_extract('properties', ['hs_esign_enabled']) }} as hs_esign_enabled,
    {{ json_extract_scalar('properties', ['hs_primary_color']) }} as hs_primary_color,
    {{ json_extract_scalar('properties', ['hs_template_type']) }} as hs_template_type,
    {{ json_extract_scalar('properties', ['hubspot_owner_id']) }} as hubspot_owner_id,
    {{ json_extract_scalar('properties', ['hs_payment_status']) }} as hs_payment_status,
    {{ json_extract_scalar('properties', ['hs_public_url_key']) }} as hs_public_url_key,
    {{ json_extract('properties', ['hs_expiration_date']) }} as hs_expiration_date,
    {{ json_extract('properties', ['hs_payment_enabled']) }} as hs_payment_enabled,
    {{ json_extract_scalar('properties', ['hs_sender_jobtitle']) }} as hs_sender_jobtitle,
    {{ json_extract_scalar('properties', ['hs_sender_lastname']) }} as hs_sender_lastname,
    {{ json_extract('properties', ['notes_last_updated']) }} as notes_last_updated,
    {{ json_extract('properties', ['hs_lastmodifieddate']) }} as hs_lastmodifieddate,
    {{ json_extract_scalar('properties', ['hs_sender_firstname']) }} as hs_sender_firstname,
    {{ json_extract_scalar('properties', ['hs_sender_image_url']) }} as hs_sender_image_url,
    {{ json_extract_scalar('properties', ['num_contacted_notes']) }} as num_contacted_notes,
    {{ json_extract_scalar('properties', ['hs_merged_object_ids']) }} as hs_merged_object_ids,
    {{ json_extract_scalar('properties', ['hs_pdf_download_link']) }} as hs_pdf_download_link,
    {{ json_extract('properties', ['notes_last_contacted']) }} as notes_last_contacted,
    {{ json_extract_scalar('properties', ['hs_created_by_user_id']) }} as hs_created_by_user_id,
    {{ json_extract_scalar('properties', ['hs_sender_company_zip']) }} as hs_sender_company_zip,
    {{ json_extract('properties', ['hs_show_signature_box']) }} as hs_show_signature_box,
    {{ json_extract_scalar('properties', ['hs_updated_by_user_id']) }} as hs_updated_by_user_id,
    {{ json_extract_scalar('properties', ['hs_sender_company_city']) }} as hs_sender_company_city,
    {{ json_extract_scalar('properties', ['hs_sender_company_name']) }} as hs_sender_company_name,
    {{ json_extract_scalar('properties', ['hs_unique_creation_key']) }} as hs_unique_creation_key,
    {{ json_extract_scalar('properties', ['hs_num_associated_deals']) }} as hs_num_associated_deals,
    {{ json_extract_scalar('properties', ['hs_sender_company_state']) }} as hs_sender_company_state,
    {{ json_extract_scalar('properties', ['hs_sender_company_domain']) }} as hs_sender_company_domain,
    {{ json_extract('properties', ['notes_next_activity_date']) }} as notes_next_activity_date,
    {{ json_extract_scalar('properties', ['hs_quote_total_preference']) }} as hs_quote_total_preference,
    {{ json_extract_scalar('properties', ['hs_sender_company_address']) }} as hs_sender_company_address,
    {{ json_extract_scalar('properties', ['hs_sender_company_country']) }} as hs_sender_company_country,
    {{ json_extract_scalar('properties', ['hs_user_ids_of_all_owners']) }} as hs_user_ids_of_all_owners,
    {{ json_extract_scalar('properties', ['hs_all_accessible_team_ids']) }} as hs_all_accessible_team_ids,
    {{ json_extract_scalar('properties', ['hs_sender_company_address2']) }} as hs_sender_company_address2,
    {{ json_extract('properties', ['hubspot_owner_assigneddate']) }} as hubspot_owner_assigneddate,
    {{ json_extract('properties', ['hs_collect_shipping_address']) }} as hs_collect_shipping_address,
    {{ json_extract('properties', ['hs_sales_email_last_replied']) }} as hs_sales_email_last_replied,
    {{ json_extract_scalar('properties', ['hs_sender_company_image_url']) }} as hs_sender_company_image_url,
    {{ json_extract('properties', ['hs_show_countersignature_box']) }} as hs_show_countersignature_box,
    {{ json_extract_scalar('properties', ['hs_esign_num_signers_required']) }} as hs_esign_num_signers_required,
    {{ json_extract_scalar('properties', ['hs_esign_num_signers_completed']) }} as hs_esign_num_signers_completed,
    {{ json_extract_scalar('properties', ['hs_all_assigned_business_unit_ids']) }} as hs_all_assigned_business_unit_ids,
    {{ json_extract_scalar('properties', ['hs_user_ids_of_all_notification_followers']) }} as hs_user_ids_of_all_notification_followers,
    {{ json_extract_scalar('properties', ['hs_user_ids_of_all_notification_unfollowers']) }} as hs_user_ids_of_all_notification_unfollowers,
    {{ json_extract_scalar('properties', ['hs_line_item_global_term_hs_discount_percentage']) }} as hs_line_item_global___s_discount_percentage,
    {{ json_extract_scalar('properties', ['hs_line_item_global_term_recurringbillingfrequency']) }} as hs_line_item_global___rringbillingfrequency,
    {{ json_extract_scalar('properties', ['hs_line_item_global_term_hs_recurring_billing_period']) }} as hs_line_item_global___urring_billing_period,
    {{ json_extract('properties', ['hs_line_item_global_term_hs_discount_percentage_enabled']) }} as hs_line_item_global___nt_percentage_enabled,
    {{ json_extract_scalar('properties', ['hs_line_item_global_term_hs_recurring_billing_start_date']) }} as hs_line_item_global___ng_billing_start_date,
    {{ json_extract('properties', ['hs_line_item_global_term_recurringbillingfrequency_enabled']) }} as hs_line_item_global___lingfrequency_enabled,
    {{ json_extract('properties', ['hs_line_item_global_term_hs_recurring_billing_period_enabled']) }} as hs_line_item_global___illing_period_enabled,
    {{ json_extract('properties', ['hs_line_item_global_term_hs_recurring_billing_start_date_enabled']) }} as hs_line_item_global___ng_start_date_enabled,
    _airbyte_emitted_at
from {{ ref('hubspot_quotes') }}
where properties is not null
-- properties at hubspot_quotes/properties

