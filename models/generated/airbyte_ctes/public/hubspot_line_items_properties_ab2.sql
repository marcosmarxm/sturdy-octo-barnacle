{{ config(schema="_airbyte_public", tags=["nested-intermediate"]) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
select
    _airbyte_hubspot_line_items_hashid,
    cast(tax as {{ dbt_utils.type_float() }}) as tax,
    cast({{ adapter.quote('name') }} as {{ dbt_utils.type_string() }}) as {{ adapter.quote('name') }},
    cast(price as {{ dbt_utils.type_float() }}) as price,
    cast(amount as {{ dbt_utils.type_float() }}) as amount,
    cast(hs_acv as {{ dbt_utils.type_float() }}) as hs_acv,
    cast(hs_arr as {{ dbt_utils.type_float() }}) as hs_arr,
    cast(hs_mrr as {{ dbt_utils.type_float() }}) as hs_mrr,
    cast(hs_sku as {{ dbt_utils.type_string() }}) as hs_sku,
    cast(hs_tcv as {{ dbt_utils.type_float() }}) as hs_tcv,
    cast(hs_url as {{ dbt_utils.type_string() }}) as hs_url,
    cast(discount as {{ dbt_utils.type_float() }}) as discount,
    cast(quantity as {{ dbt_utils.type_float() }}) as quantity,
    cast(hs_images as {{ dbt_utils.type_string() }}) as hs_images,
    cast(hs_margin as {{ dbt_utils.type_float() }}) as hs_margin,
    createdate,
    cast(description as {{ dbt_utils.type_string() }}) as description,
    cast(hs_discount as {{ dbt_utils.type_float() }}) as hs_discount,
    cast(hs_object_id as {{ dbt_utils.type_float() }}) as hs_object_id,
    hs_createdate,
    cast(hs_margin_acv as {{ dbt_utils.type_float() }}) as hs_margin_acv,
    cast(hs_margin_arr as {{ dbt_utils.type_float() }}) as hs_margin_arr,
    cast(hs_margin_mrr as {{ dbt_utils.type_float() }}) as hs_margin_mrr,
    cast(hs_margin_tcv as {{ dbt_utils.type_float() }}) as hs_margin_tcv,
    cast(hs_product_id as {{ dbt_utils.type_float() }}) as hs_product_id,
    cast(hs_sync_amount as {{ dbt_utils.type_float() }}) as hs_sync_amount,
    cast(hs_term_in_months as {{ dbt_utils.type_float() }}) as hs_term_in_months,
    hs_lastmodifieddate,
    cast(hs_merged_object_ids as {{ dbt_utils.type_string() }}) as hs_merged_object_ids,
    cast(hs_position_on_quote as {{ dbt_utils.type_float() }}) as hs_position_on_quote,
    cast(hs_cost_of_goods_sold as {{ dbt_utils.type_float() }}) as hs_cost_of_goods_sold,
    cast(hs_created_by_user_id as {{ dbt_utils.type_float() }}) as hs_created_by_user_id,
    cast(hs_updated_by_user_id as {{ dbt_utils.type_float() }}) as hs_updated_by_user_id,
    cast(hs_discount_percentage as {{ dbt_utils.type_float() }}) as hs_discount_percentage,
    cast(hs_pre_discount_amount as {{ dbt_utils.type_float() }}) as hs_pre_discount_amount,
    cast(hs_unique_creation_key as {{ dbt_utils.type_string() }}) as hs_unique_creation_key,
    cast(hs_user_ids_of_all_owners as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_owners,
    cast(recurringbillingfrequency as {{ dbt_utils.type_string() }}) as recurringbillingfrequency,
    cast(hs_all_accessible_team_ids as {{ dbt_utils.type_string() }}) as hs_all_accessible_team_ids,
    cast(hs_line_item_currency_code as {{ dbt_utils.type_string() }}) as hs_line_item_currency_code,
    cast(hs_recurring_billing_period as {{ dbt_utils.type_string() }}) as hs_recurring_billing_period,
    cast(hs_recurring_billing_end_date as {{ dbt_utils.type_string() }}) as hs_recurring_billing_end_date,
    cast(hs_recurring_billing_start_date as {{ dbt_utils.type_string() }}) as hs_recurring_billing_start_date,
    cast(hs_all_assigned_business_unit_ids as {{ dbt_utils.type_string() }}) as hs_all_assigned_business_unit_ids,
    cast(hs_user_ids_of_all_notification_followers as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_notification_followers,
    cast(hs_user_ids_of_all_notification_unfollowers as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_notification_unfollowers,
    _airbyte_emitted_at
from {{ ref('hubspot_line_items_properties_ab1') }}
-- properties at hubspot_line_items/properties

