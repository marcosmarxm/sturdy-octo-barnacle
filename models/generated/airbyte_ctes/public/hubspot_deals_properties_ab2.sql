{{ config(schema="_airbyte_public", tags=["nested-intermediate"]) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
select
    _airbyte_hubspot_deals_hashid,
    cast(amount as {{ dbt_utils.type_float() }}) as amount,
    cast(hs_acv as {{ dbt_utils.type_float() }}) as hs_acv,
    cast(hs_arr as {{ dbt_utils.type_float() }}) as hs_arr,
    cast(hs_mrr as {{ dbt_utils.type_float() }}) as hs_mrr,
    cast(hs_tcv as {{ dbt_utils.type_float() }}) as hs_tcv,
    cast(dealname as {{ dbt_utils.type_string() }}) as dealname,
    cast(dealtype as {{ dbt_utils.type_string() }}) as dealtype,
    cast(pipeline as {{ dbt_utils.type_string() }}) as pipeline,
    closedate,
    cast(dealstage as {{ dbt_utils.type_string() }}) as dealstage,
    cast(num_notes as {{ dbt_utils.type_float() }}) as num_notes,
    createdate,
    cast(description as {{ dbt_utils.type_string() }}) as description,
    cast(hs_priority as {{ dbt_utils.type_string() }}) as hs_priority,
    hs_is_closed,
    cast(hs_next_step as {{ dbt_utils.type_string() }}) as hs_next_step,
    cast(hs_object_id as {{ dbt_utils.type_float() }}) as hs_object_id,
    cast(days_to_close as {{ dbt_utils.type_float() }}) as days_to_close,
    hs_createdate,
    cast(hs_all_team_ids as {{ dbt_utils.type_string() }}) as hs_all_team_ids,
    cast(hubspot_team_id as {{ dbt_utils.type_string() }}) as hubspot_team_id,
    cast(hs_all_owner_ids as {{ dbt_utils.type_string() }}) as hs_all_owner_ids,
    cast(hs_closed_amount as {{ dbt_utils.type_float() }}) as hs_closed_amount,
    hs_is_closed_won,
    cast(hubspot_owner_id as {{ dbt_utils.type_string() }}) as hubspot_owner_id,
    cast(closed_won_reason as {{ dbt_utils.type_string() }}) as closed_won_reason,
    cast(closed_lost_reason as {{ dbt_utils.type_string() }}) as closed_lost_reason,
    cast(hs_forecast_amount as {{ dbt_utils.type_float() }}) as hs_forecast_amount,
    cast(hs_time_in_9567448 as {{ dbt_utils.type_float() }}) as hs_time_in_9567448,
    cast(hs_time_in_9567449 as {{ dbt_utils.type_float() }}) as hs_time_in_9567449,
    notes_last_updated,
    cast(hs_analytics_source as {{ dbt_utils.type_string() }}) as hs_analytics_source,
    hs_lastmodifieddate,
    cast(hs_predicted_amount as {{ dbt_utils.type_float() }}) as hs_predicted_amount,
    cast(hs_projected_amount as {{ dbt_utils.type_float() }}) as hs_projected_amount,
    cast(num_contacted_notes as {{ dbt_utils.type_float() }}) as num_contacted_notes,
    cast(hs_merged_object_ids as {{ dbt_utils.type_string() }}) as hs_merged_object_ids,
    cast(hs_time_in_closedwon as {{ dbt_utils.type_float() }}) as hs_time_in_closedwon,
    notes_last_contacted,
    cast(hs_created_by_user_id as {{ dbt_utils.type_float() }}) as hs_created_by_user_id,
    cast(hs_time_in_closedlost as {{ dbt_utils.type_float() }}) as hs_time_in_closedlost,
    cast(hs_updated_by_user_id as {{ dbt_utils.type_float() }}) as hs_updated_by_user_id,
    hs_date_exited_9567448,
    hs_date_exited_9567449,
    cast(hs_likelihood_to_close as {{ dbt_utils.type_float() }}) as hs_likelihood_to_close,
    cast(hs_num_target_accounts as {{ dbt_utils.type_float() }}) as hs_num_target_accounts,
    cast(hs_unique_creation_key as {{ dbt_utils.type_string() }}) as hs_unique_creation_key,
    cast(amount_in_home_currency as {{ dbt_utils.type_float() }}) as amount_in_home_currency,
    hs_date_entered_9567448,
    hs_date_entered_9567449,
    cast(hs_forecast_probability as {{ dbt_utils.type_float() }}) as hs_forecast_probability,
    cast(hs_time_in_contractsent as {{ dbt_utils.type_float() }}) as hs_time_in_contractsent,
    cast(num_associated_contacts as {{ dbt_utils.type_float() }}) as num_associated_contacts,
    hs_date_exited_closedwon,
    notes_next_activity_date,
    hs_date_entered_closedwon,
    hs_date_exited_closedlost,
    cast(hs_deal_stage_probability as {{ dbt_utils.type_float() }}) as hs_deal_stage_probability,
    cast(hs_time_in_qualifiedtobuy as {{ dbt_utils.type_float() }}) as hs_time_in_qualifiedtobuy,
    cast(hs_user_ids_of_all_owners as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_owners,
    cast(hs_all_accessible_team_ids as {{ dbt_utils.type_string() }}) as hs_all_accessible_team_ids,
    cast(hs_analytics_source_data_1 as {{ dbt_utils.type_string() }}) as hs_analytics_source_data_1,
    cast(hs_analytics_source_data_2 as {{ dbt_utils.type_string() }}) as hs_analytics_source_data_2,
    hs_date_entered_closedlost,
    hs_latest_meeting_activity,
    hubspot_owner_assigneddate,
    hs_date_exited_contractsent,
    cast(hs_manual_forecast_category as {{ dbt_utils.type_string() }}) as hs_manual_forecast_category,
    hs_sales_email_last_replied,
    hs_date_entered_contractsent,
    hs_date_exited_qualifiedtobuy,
    hs_date_entered_qualifiedtobuy,
    engagements_last_meeting_booked,
    cast(hs_time_in_appointmentscheduled as {{ dbt_utils.type_float() }}) as hs_time_in_appointmentscheduled,
    cast(hs_time_in_customclosedwonstage as {{ dbt_utils.type_float() }}) as hs_time_in_customclosedwonstage,
    cast(hs_deal_stage_probability_shadow as {{ dbt_utils.type_float() }}) as hs_deal_stage_probability_shadow,
    cast(hs_time_in_decisionmakerboughtin as {{ dbt_utils.type_float() }}) as hs_time_in_decisionmakerboughtin,
    cast(hs_time_in_presentationscheduled as {{ dbt_utils.type_float() }}) as hs_time_in_presentationscheduled,
    cast(hs_all_assigned_business_unit_ids as {{ dbt_utils.type_string() }}) as hs_all_assigned_business_unit_ids,
    cast(hs_closed_amount_in_home_currency as {{ dbt_utils.type_float() }}) as hs_closed_amount_in_home_currency,
    hs_date_exited_appointmentscheduled,
    hs_date_exited_customclosedwonstage,
    hs_date_entered_appointmentscheduled,
    hs_date_entered_customclosedwonstage,
    hs_date_exited_decisionmakerboughtin,
    hs_date_exited_presentationscheduled,
    cast(hs_predicted_amount_in_home_currency as {{ dbt_utils.type_float() }}) as hs_predicted_amount_in_home_currency,
    cast(hs_projected_amount_in_home_currency as {{ dbt_utils.type_float() }}) as hs_projected_amount_in_home_currency,
    hs_date_entered_decisionmakerboughtin,
    hs_date_entered_presentationscheduled,
    cast(hs_deal_amount_calculation_preference as {{ dbt_utils.type_string() }}) as hs_deal_amount_calculation_preference,
    cast(engagements_last_meeting_booked_medium as {{ dbt_utils.type_string() }}) as engagements_last_meeting_booked_medium,
    cast(engagements_last_meeting_booked_source as {{ dbt_utils.type_string() }}) as engagements_last_meeting_booked_source,
    cast(engagements_last_meeting_booked_campaign as {{ dbt_utils.type_string() }}) as engagements_last_meeting_booked_campaign,
    cast(hs_user_ids_of_all_notification_followers as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_notification_followers,
    cast(hs_user_ids_of_all_notification_unfollowers as {{ dbt_utils.type_string() }}) as hs_user_ids_of_all_notification_unfollowers,
    cast(hs_line_item_global___s_discount_percentage as {{ dbt_utils.type_string() }}) as hs_line_item_global___s_discount_percentage,
    cast(hs_line_item_global___rringbillingfrequency as {{ dbt_utils.type_string() }}) as hs_line_item_global___rringbillingfrequency,
    cast(hs_line_item_global___urring_billing_period as {{ dbt_utils.type_string() }}) as hs_line_item_global___urring_billing_period,
    hs_line_item_global___nt_percentage_enabled,
    cast(hs_line_item_global___ng_billing_start_date as {{ dbt_utils.type_string() }}) as hs_line_item_global___ng_billing_start_date,
    hs_line_item_global___lingfrequency_enabled,
    hs_line_item_global___illing_period_enabled,
    hs_line_item_global___ng_start_date_enabled,
    _airbyte_emitted_at
from {{ ref('hubspot_deals_properties_ab1') }}
-- properties at hubspot_deals/properties

