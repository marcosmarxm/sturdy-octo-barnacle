{{ config(schema="_airbyte_public", tags=["nested-intermediate"]) }}
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
select
    _airbyte_associated_company_hashid,
    cast(zip as {{ type_json() }}) as zip,
    cast(city as {{ type_json() }}) as city,
    cast({{ adapter.quote('name') }} as {{ type_json() }}) as {{ adapter.quote('name') }},
    cast({{ adapter.quote('type') }} as {{ type_json() }}) as {{ adapter.quote('type') }},
    cast(phone as {{ type_json() }}) as phone,
    cast({{ adapter.quote('state') }} as {{ type_json() }}) as {{ adapter.quote('state') }},
    cast({{ adapter.quote('domain') }} as {{ type_json() }}) as {{ adapter.quote('domain') }},
    cast(address as {{ type_json() }}) as address,
    cast(country as {{ type_json() }}) as country,
    cast(website as {{ type_json() }}) as website,
    cast(about_us as {{ type_json() }}) as about_us,
    cast(address2 as {{ type_json() }}) as address2,
    cast(industry as {{ type_json() }}) as industry,
    cast(timezone as {{ type_json() }}) as timezone,
    cast(closedate as {{ type_json() }}) as closedate,
    cast(is_public as {{ type_json() }}) as is_public,
    cast(num_notes as {{ type_json() }}) as num_notes,
    cast(createdate as {{ type_json() }}) as createdate,
    cast(twitterbio as {{ type_json() }}) as twitterbio,
    cast(description as {{ type_json() }}) as description,
    cast(linkedinbio as {{ type_json() }}) as linkedinbio,
    cast(facebookfans as {{ type_json() }}) as facebookfans,
    cast(founded_year as {{ type_json() }}) as founded_year,
    cast(hs_object_id as {{ type_json() }}) as hs_object_id,
    cast(annualrevenue as {{ type_json() }}) as annualrevenue,
    cast(days_to_close as {{ type_json() }}) as days_to_close,
    cast(hs_createdate as {{ type_json() }}) as hs_createdate,
    cast(total_revenue as {{ type_json() }}) as total_revenue,
    cast(twitterhandle as {{ type_json() }}) as twitterhandle,
    cast(hs_lead_status as {{ type_json() }}) as hs_lead_status,
    cast(lifecyclestage as {{ type_json() }}) as lifecyclestage,
    cast(googleplus_page as {{ type_json() }}) as googleplus_page,
    cast(hs_all_team_ids as {{ type_json() }}) as hs_all_team_ids,
    cast(hs_num_blockers as {{ type_json() }}) as hs_num_blockers,
    cast(hubspot_team_id as {{ type_json() }}) as hubspot_team_id,
    cast(hs_all_owner_ids as {{ type_json() }}) as hs_all_owner_ids,
    cast(hubspot_owner_id as {{ type_json() }}) as hubspot_owner_id,
    cast(twitterfollowers as {{ type_json() }}) as twitterfollowers,
    cast(web_technologies as {{ type_json() }}) as web_technologies,
    cast(hs_num_open_deals as {{ type_json() }}) as hs_num_open_deals,
    cast(hs_target_account as {{ type_json() }}) as hs_target_account,
    cast(numberofemployees as {{ type_json() }}) as numberofemployees,
    cast(notes_last_updated as {{ type_json() }}) as notes_last_updated,
    cast(recent_deal_amount as {{ type_json() }}) as recent_deal_amount,
    cast(total_money_raised as {{ type_json() }}) as total_money_raised,
    cast(hs_analytics_source as {{ type_json() }}) as hs_analytics_source,
    cast(hs_lastmodifieddate as {{ type_json() }}) as hs_lastmodifieddate,
    cast(hs_total_deal_value as {{ type_json() }}) as hs_total_deal_value,
    cast(num_contacted_notes as {{ type_json() }}) as num_contacted_notes,
    cast(hs_is_target_account as {{ type_json() }}) as hs_is_target_account,
    cast(hs_merged_object_ids as {{ type_json() }}) as hs_merged_object_ids,
    cast(hs_parent_company_id as {{ type_json() }}) as hs_parent_company_id,
    cast(notes_last_contacted as {{ type_json() }}) as notes_last_contacted,
    cast(num_associated_deals as {{ type_json() }}) as num_associated_deals,
    cast(facebook_company_page as {{ type_json() }}) as facebook_company_page,
    cast(hs_additional_domains as {{ type_json() }}) as hs_additional_domains,
    cast(hs_created_by_user_id as {{ type_json() }}) as hs_created_by_user_id,
    cast(hs_updated_by_user_id as {{ type_json() }}) as hs_updated_by_user_id,
    cast(linkedin_company_page as {{ type_json() }}) as linkedin_company_page,
    cast(hs_last_open_task_date as {{ type_json() }}) as hs_last_open_task_date,
    cast(hs_num_child_companies as {{ type_json() }}) as hs_num_child_companies,
    cast(hs_num_decision_makers as {{ type_json() }}) as hs_num_decision_makers,
    cast(recent_deal_close_date as {{ type_json() }}) as recent_deal_close_date,
    cast(first_deal_created_date as {{ type_json() }}) as first_deal_created_date,
    cast(hs_analytics_num_visits as {{ type_json() }}) as hs_analytics_num_visits,
    cast(num_associated_contacts as {{ type_json() }}) as num_associated_contacts,
    cast(first_contact_createdate as {{ type_json() }}) as first_contact_createdate,
    cast(hs_last_logged_call_date as {{ type_json() }}) as hs_last_logged_call_date,
    cast(notes_next_activity_date as {{ type_json() }}) as notes_next_activity_date,
    cast(hs_avatar_filemanager_key as {{ type_json() }}) as hs_avatar_filemanager_key,
    cast(hs_ideal_customer_profile as {{ type_json() }}) as hs_ideal_customer_profile,
    cast(hs_user_ids_of_all_owners as {{ type_json() }}) as hs_user_ids_of_all_owners,
    cast(hs_all_accessible_team_ids as {{ type_json() }}) as hs_all_accessible_team_ids,
    cast(hs_analytics_source_data_1 as {{ type_json() }}) as hs_analytics_source_data_1,
    cast(hs_analytics_source_data_2 as {{ type_json() }}) as hs_analytics_source_data_2,
    cast(hs_latest_meeting_activity as {{ type_json() }}) as hs_latest_meeting_activity,
    cast(hubspot_owner_assigneddate as {{ type_json() }}) as hubspot_owner_assigneddate,
    cast(hs_analytics_last_timestamp as {{ type_json() }}) as hs_analytics_last_timestamp,
    cast(hs_analytics_num_page_views as {{ type_json() }}) as hs_analytics_num_page_views,
    cast(hs_last_booked_meeting_date as {{ type_json() }}) as hs_last_booked_meeting_date,
    cast(hs_last_sales_activity_date as {{ type_json() }}) as hs_last_sales_activity_date,
    cast(hs_sales_email_last_replied as {{ type_json() }}) as hs_sales_email_last_replied,
    cast(hs_analytics_first_timestamp as {{ type_json() }}) as hs_analytics_first_timestamp,
    cast(hs_target_account_probability as {{ type_json() }}) as hs_target_account_probability,
    cast(engagements_last_meeting_booked as {{ type_json() }}) as engagements_last_meeting_booked,
    cast(hs_last_sales_activity_timestamp as {{ type_json() }}) as hs_last_sales_activity_timestamp,
    cast(hs_analytics_last_visit_timestamp as {{ type_json() }}) as hs_analytics_last_visit_timestamp,
    cast(hs_num_contacts_with_buying_roles as {{ type_json() }}) as hs_num_contacts_with_buying_roles,
    cast(hs_analytics_first_visit_timestamp as {{ type_json() }}) as hs_analytics_first_visit_timestamp,
    cast(engagements_last_meeting_booked_medium as {{ type_json() }}) as engagements_last_meeting_booked_medium,
    cast(engagements_last_meeting_booked_source as {{ type_json() }}) as engagements_last_meeting_booked_source,
    cast(hs_target_account_recommendation_state as {{ type_json() }}) as hs_target_account_recommendation_state,
    cast(engagements_last_meeting_booked_campaign as {{ type_json() }}) as engagements_last_meeting_booked_campaign,
    cast(closedate_timestamp_earliest_value_a2a17e6e as {{ type_json() }}) as closedate_timestamp_earliest_value_a2a17e6e,
    cast(hs_analytics_last_touch_converting_campaign as {{ type_json() }}) as hs_analytics_last_touch_converting_campaign,
    cast(hs_analytics_first_t__h_converting_campaign as {{ type_json() }}) as hs_analytics_first_t__h_converting_campaign,
    cast(hs_target_account_re__mendation_snooze_time as {{ type_json() }}) as hs_target_account_re__mendation_snooze_time,
    cast(num_conversion_event__dinality_sum_d095f14b as {{ type_json() }}) as num_conversion_event__dinality_sum_d095f14b,
    cast(hs_analytics_num_vis__dinality_sum_53d952a6 as {{ type_json() }}) as hs_analytics_num_vis__dinality_sum_53d952a6,
    cast(hs_predictivecontact__next_max_max_d4e58c1e as {{ type_json() }}) as hs_predictivecontact__next_max_max_d4e58c1e,
    cast(hs_analytics_num_pag__dinality_sum_e46e85b0 as {{ type_json() }}) as hs_analytics_num_pag__dinality_sum_e46e85b0,
    cast(hs_analytics_source___rliest_value_25a3a52c as {{ type_json() }}) as hs_analytics_source___rliest_value_25a3a52c,
    cast(recent_conversion_da__latest_value_72856da1 as {{ type_json() }}) as recent_conversion_da__latest_value_72856da1,
    cast(first_conversion_dat__rliest_value_61f58f2c as {{ type_json() }}) as first_conversion_dat__rliest_value_61f58f2c,
    cast(first_contact_create__rliest_value_78b50eea as {{ type_json() }}) as first_contact_create__rliest_value_78b50eea,
    cast(hs_analytics_last_ti__latest_value_4e16365a as {{ type_json() }}) as hs_analytics_last_ti__latest_value_4e16365a,
    cast(hs_analytics_source___rliest_value_9b2f1fa1 as {{ type_json() }}) as hs_analytics_source___rliest_value_9b2f1fa1,
    cast(hs_analytics_source___rliest_value_9b2f9400 as {{ type_json() }}) as hs_analytics_source___rliest_value_9b2f9400,
    cast(recent_conversion_ev__latest_value_66c820bf as {{ type_json() }}) as recent_conversion_ev__latest_value_66c820bf,
    cast(first_conversion_eve__rliest_value_68ddae0a as {{ type_json() }}) as first_conversion_eve__rliest_value_68ddae0a,
    cast(hs_analytics_first_t__rliest_value_11e3a63a as {{ type_json() }}) as hs_analytics_first_t__rliest_value_11e3a63a,
    cast(hs_analytics_last_vi__latest_value_999a0fce as {{ type_json() }}) as hs_analytics_last_vi__latest_value_999a0fce,
    cast(hs_analytics_first_v__rliest_value_accc17ae as {{ type_json() }}) as hs_analytics_first_v__rliest_value_accc17ae,
    cast(hs_analytics_last_to__latest_value_81a64e30 as {{ type_json() }}) as hs_analytics_last_to__latest_value_81a64e30,
    cast(hs_analytics_first_t__rliest_value_4757fe10 as {{ type_json() }}) as hs_analytics_first_t__rliest_value_4757fe10,
    _airbyte_emitted_at
from {{ ref('hubspot_contacts_ass__ed_company_properties_ab1') }}
-- properties at hubspot_contacts/associated-company/properties

